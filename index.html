<!-- दूध संकलन -->
<section id="collection">
  <h3>दूध संकलन रेकॉर्ड</h3>
  <form onsubmit="event.preventDefault();saveCollection();">
    तारीख:<input type="date" id="c_date" required>
    लिटर:<input type="number" id="c_liter" required>
    फॅट:<input type="number" id="c_fat" step="0.1" required>
    रक्कम:<input type="number" id="c_amount" required>
    प्रकार:
    <select id="c_type" required>
      <option value="गाय">गाय (Cow)</option>
      <option value="म्हैस">म्हैस (Buffalo)</option>
    </select>
    <button type="submit">सेव्ह</button>
  </form>
  <table id="collectionTable">
    <thead>
      <tr>
        <th>तारीख</th>
        <th>प्रकार</th>
        <th>लिटर</th>
        <th>फॅट</th>
        <th>रक्कम</th>
      </tr>
    </thead>
    <tbody id="collectionBody"></tbody>
  </table>
</section>

<!-- रिपोर्ट्स -->
<section id="reports">
  <h3>रिपोर्ट्स डाउनलोड</h3>
  <button onclick="downloadCollectionPDF()">दूध संकलन PDF</button>
  <button onclick="downloadSuppliersPDF()">पुरवठादार PDF</button>
</section>

<script>
  // दूध संकलन सेव्ह
  window.saveCollection=function(){
    push(ref(db,'milkCollection'),{
      date:document.getElementById('c_date').value,
      type:document.getElementById('c_type').value,
      liter:document.getElementById('c_liter').value,
      fat:document.getElementById('c_fat').value,
      amount:document.getElementById('c_amount').value
    }).then(()=>alert('सेव्ह झालं'));
  }

  // वाचणे
  onValue(ref(db,'milkCollection'),snap=>{
    const tb=document.getElementById('collectionBody');
    tb.innerHTML='';
    const data=snap.val();
    for(let k in data){
      let r=data[k];
      tb.innerHTML+=`<tr>
        <td>${r.date}</td>
        <td>${r.type}</td>
        <td>${r.liter}</td>
        <td>${r.fat}</td>
        <td>${r.amount}</td>
      </tr>`;
    }
  });

  // PDF (फक्त टेबलच्या हेडिंग्स जशा HTML मध्ये आहेत तशाच)
  window.downloadCollectionPDF=function(){
    const { jsPDF }=window.jspdf;
    const doc=new jsPDF();
    doc.setFontSize(14);
    doc.text('दूध संकलन रेकॉर्ड', doc.internal.pageSize.getWidth()/2, 15, {align:'center'});
    doc.autoTable({
      html:'#collectionTable',
      startY:25,
      headStyles:{fillColor:[41,128,185]},
      styles:{font:'helvetica',fontSize:10,cellPadding:2}
    });
    doc.save('दूध-संकलन.pdf');
  }
</script>
