<!DOCTYPE html>
<html lang="mr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>üêÑ ‡§≠‡§æ‡§µ‡•á‡§∂‡•ç‡§µ‡§∞‡•Ä ‡§¶‡•Ç‡§ß ‡§∏‡§Ç‡§∏‡•ç‡§•‡§æ ,‡§ó‡•ã‡§∞‡§Ç‡§¨‡•á</title>
  <style>
    body{
      font-family:'Noto Sans Devanagari',sans-serif;
      max-width:800px;
      margin:auto;
      padding:10px;
    }
    h2{text-align:center;}
    form{
      background:#f4f4f4;
      padding:10px;
      border-radius:5px;
    }
    label{display:block;margin-top:5px;}
    input,select,button{
      width:100%;
      padding:8px;
      margin-top:2px;
      box-sizing:border-box;
      font-size:1rem;
    }
    table{width:100%;border-collapse:collapse;margin-top:15px;font-size:0.9rem;}
    th,td{border:1px solid #ccc;padding:5px;text-align:center;}
    th{background:#eee;}
    @media(max-width:600px){
      table,thead,tbody,th,td,tr{display:block;width:100%;}
      th{position:sticky;top:0;}
    }
  </style>
</head>
<body>
  <h2>üêÑ ‡§≠‡§æ‡§µ‡•á‡§∂‡•ç‡§µ‡§∞‡•Ä ‡§¶‡•Ç‡§ß ‡§∏‡§Ç‡§∏‡•ç‡§•‡§æ ,‡§ó‡•ã‡§∞‡§Ç‡§¨‡•á</h2>

  <!-- ‡§´‡•â‡§∞‡•ç‡§Æ -->
  <form onsubmit="event.preventDefault();saveCollection();">
    <label>‡§Æ‡•á‡§Ç‡§¨‡§∞ ‡§®‡§Ç‡§¨‡§∞:</label>
    <input type="number" id="memberNo" oninput="autoFillName()" placeholder="‡§®‡§Ç‡§¨‡§∞ ‡§ü‡§æ‡§ï‡§æ" required>

    <label>‡§®‡§æ‡§µ:</label>
    <input type="text" id="memberName" readonly placeholder="‡§Ü‡§™‡•ã‡§Ü‡§™ ‡§Ø‡•á‡§à‡§≤">

    <label>‡§§‡§æ‡§∞‡•Ä‡§ñ:</label>
    <input type="date" id="c_date" required>

    <label>‡§™‡•ç‡§∞‡§ï‡§æ‡§∞:</label>
    <select id="c_type" required>
      <option value="">‡§®‡§ø‡§µ‡§°‡§æ</option>
      <option value="‡§ó‡§æ‡§Ø">‡§ó‡§æ‡§Ø (Cow)</option>
      <option value="‡§Æ‡•ç‡§π‡•à‡§∏">‡§Æ‡•ç‡§π‡•à‡§∏ (Buffalo)</option>
    </select>

    <label>‡§≤‡§ø‡§ü‡§∞:</label>
    <input type="number" id="c_liter" step="0.1" required>

    <label>‡§´‡•Ö‡§ü:</label>
    <input type="number" id="c_fat" step="0.1" required>

    <label>‡§∞‡•á‡§ü (‚Çπ):</label>
    <input type="number" id="c_rate" step="0.1" required>

    <button type="submit">‡§∏‡•á‡§µ‡•ç‡§π ‡§ï‡§∞‡§æ</button>
  </form>

  <!-- ‡§ü‡•á‡§¨‡§≤ -->
  <h3 style="margin-top:15px;">‡§¶‡•Ç‡§ß ‡§∏‡§Ç‡§ï‡§≤‡§® ‡§∞‡•á‡§ï‡•â‡§∞‡•ç‡§°</h3>
  <table>
    <thead>
      <tr>
        <th>‡§Æ‡•á‡§Ç‡§¨‡§∞ ‡§®‡§Ç‡§¨‡§∞</th>
        <th>‡§®‡§æ‡§µ</th>
        <th>‡§§‡§æ‡§∞‡•Ä‡§ñ</th>
        <th>‡§™‡•ç‡§∞‡§ï‡§æ‡§∞</th>
        <th>‡§≤‡§ø‡§ü‡§∞</th>
        <th>‡§´‡•Ö‡§ü</th>
        <th>‡§∞‡•á‡§ü</th>
        <th>‡§∞‡§ï‡•ç‡§ï‡§Æ</th>
      </tr>
    </thead>
    <tbody id="collectionBody"></tbody>
  </table>

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
    import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";

    // üîπ ‡§§‡•Å‡§ù‡§Ç firebaseConfig ‡§á‡§•‡•á ‡§ü‡§æ‡§ï
    const firebaseConfig = {
      apiKey: "AIzaSyD_4wQmuzFPJjid-Co9Y-6vgEb70jxWTSY",
      authDomain: "dairy-mill-production.firebaseapp.com",
      databaseURL: "https://dairy-mill-production-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "dairy-mill-production",
      storageBucket: "dairy-mill-production.firebasestorage.app",
      messagingSenderId: "721651192386",
      appId: "1:721651192386:web:b5613cedce06deed1e13db",
      measurementId: "G-YQ2BDHS8HG"
    };

    // Init Firebase
    const app=initializeApp(firebaseConfig);
    const db=getDatabase(app);

    // üîπ ‡§°‡•á‡§Æ‡•ã ‡§Æ‡•á‡§Ç‡§¨‡§∞ ‡§≤‡§ø‡§∏‡•ç‡§ü
    const memberList={
      101:"‡§∏‡§Ç‡§§‡•ã‡§∑ ‡§™‡§æ‡§ü‡•Ä‡§≤",
      102:"‡§∞‡§æ‡§ú‡•á‡§∂ ‡§ú‡§æ‡§ß‡§µ",
      103:"‡§∏‡•Å‡§®‡§ø‡§§‡§æ ‡§ï‡§æ‡§≥‡•á",
      104:"‡§Ö‡§ú‡§Ø ‡§∂‡§ø‡§Ç‡§¶‡•á",
      105:"‡§Ø‡•ã‡§ó‡•á‡§∂ ‡§ï‡§¶‡§Æ",
      106:"‡§∏‡•ç‡§Æ‡§ø‡§§‡§æ ‡§∏‡§æ‡§µ‡§Ç‡§§",
      107:"‡§ó‡§£‡•á‡§∂ ‡§¶‡•á‡§∂‡§Æ‡•Å‡§ñ",
      108:"‡§™‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§™‡§µ‡§æ‡§∞",
      109:"‡§Æ‡§æ‡§ß‡§µ ‡§Æ‡§æ‡§≥‡•Ä",
      110:"‡§∏‡§™‡§®‡§æ ‡§Æ‡•ã‡§∞‡•á"
    };

    // ‡§®‡§æ‡§µ auto-fill
    window.autoFillName=function(){
      const no=document.getElementById('memberNo').value;
      document.getElementById('memberName').value=memberList[no]||"";
    }

    // ‡§∏‡•á‡§µ‡•ç‡§π
    window.saveCollection=function(){
      const no=document.getElementById('memberNo').value;
      const name=document.getElementById('memberName').value;
      const date=document.getElementById('c_date').value;
      const type=document.getElementById('c_type').value;
      const liters=document.getElementById('c_liter').value;
      const fat=document.getElementById('c_fat').value;
      const rate=document.getElementById('c_rate').value;
      const amount=(parseFloat(liters)*parseFloat(rate)).toFixed(2);

      if(!name){alert("‡§Æ‡•á‡§Ç‡§¨‡§∞ ‡§®‡§Ç‡§¨‡§∞ ‡§ú‡•Å‡§≥‡§≤‡§æ ‡§®‡§æ‡§π‡•Ä ‚ùå");return;}

      push(ref(db,'milkCollection'),{
        memberNo:no,
        name:name,
        date:date,
        type:type,
        liters:liters,
        fat:fat,
        rate:rate,
        amount:amount
      }).then(()=>{
        alert('‡§∏‡•á‡§µ‡•ç‡§π ‚úÖ');
        document.querySelector('form').reset();
        document.getElementById('memberName').value='';
      });
    }

    // ‡§∂‡•ã
    onValue(ref(db,'milkCollection'),snap=>{
      const tb=document.getElementById('collectionBody');
      tb.innerHTML='';
      const data=snap.val()||{};
      for(let k in data){
        let r=data[k];
        tb.innerHTML+=`
          <tr>
            <td>${r.memberNo}</td>
            <td>${r.name}</td>
            <td>${r.date}</td>
            <td>${r.type}</td>
            <td>${r.liters}</td>
            <td>${r.fat}</td>
            <td>${r.rate}</td>
            <td>${r.amount}</td>
          </tr>`;
      }
    });
  </script>
</body>
</html>
