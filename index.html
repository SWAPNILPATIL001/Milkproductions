<!DOCTYPE html>
<html lang="mr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>‡§≠‡§æ‡§µ‡•á‡§∂‡•ç‡§µ‡§∞‡•Ä ‡§¶‡•Ç‡§ß ‡§∏‡§Ç‡§∏‡•ç‡§•‡§æ</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
  <style>
    body {font-family:'Poppins',sans-serif;max-width:800px;margin:auto;padding:10px;}
    h2{text-align:center;}
    form input, form select{width:100%;padding:8px;margin:4px 0;}
    button{padding:8px 12px;margin-top:6px;}
    table{width:100%;border-collapse:collapse;margin-top:10px;}
    th,td{border:1px solid #ccc;padding:6px;text-align:center;}
    .milk-can{display:flex;align-items:center;justify-content:center;background:#f0f8ff;padding:10px;margin:10px 0;border-radius:6px;}
    .milk-can img{width:50px;height:50px;margin-right:10px;}
  </style>
</head>
<body>
  <h2>üêÑ ‡§≠‡§æ‡§µ‡•á‡§∂‡•ç‡§µ‡§∞‡•Ä ‡§¶‡•Ç‡§ß ‡§∏‡§Ç‡§∏‡•ç‡§•‡§æ</h2>

  <div class="milk-can">
    <img src="https://cdn-icons-png.flaticon.com/512/1047/1047710.png" alt="milk can">
    <div>‡§Ü‡§ú‡§™‡§∞‡•ç‡§Ø‡§Ç‡§§‡§ö‡•á ‡§≤‡§ø‡§ü‡§∞: <span id="totalLiters">0</span></div>
  </div>

  <!-- ‡§™‡•Å‡§∞‡§µ‡§†‡§æ‡§¶‡§æ‡§∞ ‡§®‡§Ç‡§¨‡§∞ ‡§µ ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä -->
  <label>‡§™‡•Å‡§∞‡§µ‡§†‡§æ‡§¶‡§æ‡§∞ ‡§Æ‡•ã‡§¨‡§æ‡§à‡§≤:</label>
  <input type="number" id="mobile" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§à‡§≤ ‡§®‡§Ç‡§¨‡§∞" oninput="autoFillName()">
  <label>‡§®‡§æ‡§µ:</label>
  <input type="text" id="name" readonly>

  <form id="milkForm" onsubmit="event.preventDefault(); submitMilkData();">
    <label>‡§§‡§æ‡§∞‡•Ä‡§ñ:</label>
    <input type="date" id="date" required>
    <label>‡§™‡•ç‡§∞‡§ï‡§æ‡§∞:</label>
    <select id="animal" required>
      <option value="‡§ó‡§æ‡§Ø">‡§ó‡§æ‡§Ø</option>
      <option value="‡§Æ‡•ç‡§π‡•à‡§∏">‡§Æ‡•ç‡§π‡•à‡§∏</option>
    </select>
    <label>‡§≤‡§ø‡§ü‡§∞:</label>
    <input type="number" id="liters" step="0.1" required>
    <label>‡§´‡•Ö‡§ü:</label>
    <input type="number" id="fat" step="0.1" required oninput="autoFillRate()">
    <label>SNF:</label>
    <input type="number" id="snf" step="0.1" required oninput="autoFillRate()">
    <label>‡§∞‡•á‡§ü (‚Çπ ‡§™‡•ç‡§∞‡§§‡§ø ‡§≤‡§ø‡§ü‡§∞):</label>
    <input type="number" id="rate" step="0.1" readonly>
    <button type="submit">‡§°‡•á‡§ü‡§æ ‡§∏‡•á‡§µ‡•ç‡§π ‡§ï‡§∞‡§æ</button>
  </form>

  <h3>‡§∏‡§Ç‡§ï‡§≤‡§® ‡§∞‡•á‡§ï‡•â‡§∞‡•ç‡§°:</h3>
  <table>
    <thead>
      <tr>
        <th>‡§§‡§æ‡§∞‡•Ä‡§ñ</th>
        <th>‡§®‡§æ‡§µ</th>
        <th>‡§Æ‡•ã‡§¨‡§æ‡§à‡§≤</th>
        <th>‡§™‡•ç‡§∞‡§ï‡§æ‡§∞</th>
        <th>‡§≤‡§ø‡§ü‡§∞</th>
        <th>‡§´‡•Ö‡§ü</th>
        <th>SNF</th>
        <th>‡§∞‡•á‡§ü</th>
        <th>‡§∞‡§ï‡•ç‡§ï‡§Æ</th>
      </tr>
    </thead>
    <tbody id="dataBody"></tbody>
  </table>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
    import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyD_4wQmuzFPJjid-Co9Y-6vgEb70jxWTSY",
      authDomain: "dairy-mill-production.firebaseapp.com",
      databaseURL: "https://dairy-mill-production-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "dairy-mill-production",
      storageBucket: "dairy-mill-production.firebasestorage.app",
      messagingSenderId: "721651192386",
      appId: "1:721651192386:web:b5613cedce06deed1e13db",
      measurementId: "G-YQ2BDHS8HG"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // sample suppliers
    const suppliers = {
      "9876543210":"‡§∞‡§æ‡§Æ",
      "9876543211":"‡§∂‡•ç‡§Ø‡§æ‡§Æ",
      "9876543212":"‡§∏‡§ö‡§ø‡§®",
      "9876543213":"‡§∏‡§Ç‡§¶‡•Ä‡§™",
      "9876543214":"‡§Æ‡§®‡•Ä‡§∑",
      "9876543215":"‡§∏‡•ã‡§®‡§æ‡§≤‡•Ä",
      "9876543216":"‡§≠‡•Ç‡§∑‡§£",
      "9876543217":"‡§µ‡§ø‡§®‡§æ‡§Ø‡§ï",
      "9876543218":"‡§™‡•Ç‡§ú‡§æ",
      "9876543219":"‡§™‡•ç‡§∞‡§∏‡§æ‡§¶"
    };

    window.autoFillName = function(){
      const mob=document.getElementById('mobile').value;
      document.getElementById('name').value=suppliers[mob]||'';
    };

    // sample rate chart (fill full table)
    const rateChart={
      "6.0":{"8.3":33.60,"8.4":33.80},
      "6.2":{"8.3":33.80,"8.4":34.00},
      "6.4":{"8.3":34.00,"8.4":34.20}
    };

    window.autoFillRate=function(){
      const fat=document.getElementById('fat').value;
      const snf=document.getElementById('snf').value;
      if(rateChart[fat] && rateChart[fat][snf]){
        document.getElementById('rate').value=rateChart[fat][snf];
      }else{
        document.getElementById('rate').value='';
      }
    };

    window.submitMilkData=function(){
      const date=document.getElementById('date').value;
      const name=document.getElementById('name').value;
      const mobile=document.getElementById('mobile').value;
      const animal=document.getElementById('animal').value;
      const liters=document.getElementById('liters').value;
      const fat=document.getElementById('fat').value;
      const snf=document.getElementById('snf').value;
      const rate=document.getElementById('rate').value;
      const amount=(parseFloat(liters)*parseFloat(rate)).toFixed(2);

      push(ref(db,'milkCollection'),{
        date,name,mobile,animal,liters,fat,snf,rate,amount
      }).then(()=>{
        alert('‡§°‡•á‡§ü‡§æ ‡§∏‡•á‡§µ‡•ç‡§π ‡§ù‡§æ‡§≤‡§æ ‚úÖ');
        document.getElementById('milkForm').reset();
      });
    };

    const dataRef=ref(db,'milkCollection');
    onValue(dataRef,(snapshot)=>{
      const data=snapshot.val();
      const tableBody=document.getElementById('dataBody');
      tableBody.innerHTML='';
      let total=0;
      for(let key in data){
        const row=data[key];
        total+=parseFloat(row.liters);
        tableBody.innerHTML+=`
          <tr>
            <td>${row.date}</td>
            <td>${row.name}</td>
            <td>${row.mobile}</td>
            <td>${row.animal}</td>
            <td>${row.liters}</td>
            <td>${row.fat}</td>
            <td>${row.snf}</td>
            <td>${row.rate}</td>
            <td>${row.amount}</td>
          </tr>`;
      }
      document.getElementById('totalLiters').textContent=total.toFixed(1);
    });
  </script>
</body>
</html>
